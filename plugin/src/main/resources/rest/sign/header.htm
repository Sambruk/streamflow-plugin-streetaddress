<!--

    Copyright 2011 Streamsource AB. All Rights Reserved by Streamsource AB.

    The content of this file is property of Streamsource AB, org no 556777-9896, with the address
    Hans Michelsensgatan 9, SE-211 20 MalmÃ¶, Sweden. Any unauthorized review, use, disclosure
    or distribution is prohibited.

-->
<script type="text/javascript">

function addSigners(node) {

#if ($request.getClientInfo().getAgentName().contains("MSIE"))
	if (isPluginInstalled("Nexus.SignerV2Ctl"))
		node.append('<object id="signer2" name="signer2" classid="CLSID:FB25B6FD-2119-4CEF-A915-A056184C565E" width="0" height="0"></object');
#else
	if (isPluginInstalled("application/x-personal-signer2"))
		node.append('<object id="signer2" type="application/x-personal-signer2" width="0" height="0"></object>');
#end
   
#if ($request.getClientInfo().getAgentName().contains("MSIE"))
	if (isPluginInstalled("Nexus.SignerCtl"))
		node.append('<object id="signer" name="signer" classid="CLSID:6969E7D5-223A-4982-9B79-CC4FAC2D5E5E" width="0" height="0"></object>');
#else
	if (isPluginInstalled("application/x-personal-signer"))
		node.append('<object id="signer" type="application/x-personal-signer" width="0" height="0"></object>');
#end		
    
#if ($request.getClientInfo().getAgentName().contains("MSIE"))
	if (isPluginInstalled("IID.PluginCtl"))
		node.append('<object id="iid" classid="CLSID:5BF56AD2-E297-416E-BC49-00B327C4426E" width="0" height="0"></object>');
#else
	if (isPluginInstalled("application/x-iid"))
		node.append('<object id="iid" type="application/x-iid" width="0" height="0"></object>');
#end
}

#if ($request.getClientInfo().getAgentName().contains("MSIE"))
	
	function isPluginInstalled(name){
		try {
			var xObj = new ActiveXObject(name);
			if(xObj) {
				return true;
			}
		} catch (e) {
			return false;;
		}
	}
#else
	function isPluginInstalled(name){
		if(navigator.plugins) {
			if (navigator.plugins.length > 0) {
				if (navigator.mimeTypes && navigator.mimeTypes[name]) {
					if (navigator.mimeTypes[name].enabledPlugin){
						return true;
					}
				}
			}
		}
		return false;
	}
#end



</script>